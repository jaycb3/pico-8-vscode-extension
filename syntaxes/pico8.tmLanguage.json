{
  "name": "PICO-8",
  "scopeName": "source.pico8",
  "fileTypes": ["p8"],
  "patterns": [
    { "include": "#comments" },
    { "include": "#strings" },
    { "include": "#numbers" },
    { "include": "#keywords" },
    { "include": "#functions" },
    { "include": "#operators" },
    { "include": "#constants" }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.block.pico8",
          "begin": "--\\[\\[",
          "end": "\\]\\]"
        },
        {
          "name": "comment.line.double-dash.pico8",
          "match": "--.*$"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.pico8",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.pico8",
              "match": "\\\\."
            }
          ]
        },
        {
          "name": "string.quoted.single.pico8",
          "begin": "'",
          "end": "'",
          "patterns": [
            {
              "name": "constant.character.escape.pico8",
              "match": "\\\\."
            }
          ]
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.hex.pico8",
          "match": "\\b0[xX][0-9a-fA-F]+(\\.[0-9a-fA-F]+)?\\b"
        },
        {
          "name": "constant.numeric.binary.pico8",
          "match": "\\b0[bB][01]+\\b"
        },
        {
          "name": "constant.numeric.decimal.pico8",
          "match": "\\b[0-9]+(\\.[0-9]+)?([eE][+-]?[0-9]+)?\\b"
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.pico8",
          "match": "\\b(if|then|else|elseif|end|while|do|for|in|repeat|until|break|return|local|function|goto)\\b"
        },
        {
          "name": "keyword.operator.logical.pico8",
          "match": "\\b(and|or|not)\\b"
        },
        {
          "name": "constant.language.pico8",
          "match": "\\b(true|false|nil)\\b"
        }
      ]
    },
    "functions": {
      "patterns": [
        {
          "name": "entity.name.function.pico8.callback",
          "match": "\\b(_init|_update|_update60|_draw)\\b"
        },
        {
          "name": "support.function.pico8.graphics",
          "match": "\\b(pset|pget|sset|sget|spr|sspr|pal|palt|cls|camera|clip|rectfill|circfill|rect|circ|line|ovalfill|oval|fillp|color|cursor|print)\\b"
        },
        {
          "name": "support.function.pico8.tables",
          "match": "\\b(add|del|deli|count|all|foreach|pairs)\\b"
        },
        {
          "name": "support.function.pico8.input",
          "match": "\\b(btn|btnp)\\b"
        },
        {
          "name": "support.function.pico8.audio",
          "match": "\\b(sfx|music)\\b"
        },
        {
          "name": "support.function.pico8.map",
          "match": "\\b(mget|mset|map|tline)\\b"
        },
        {
          "name": "support.function.pico8.math",
          "match": "\\b(max|min|mid|flr|ceil|cos|sin|atan2|sqrt|abs|sgn|rnd|srand|band|bor|bxor|bnot|shl|shr|lshr|rotl|rotr)\\b"
        },
        {
          "name": "support.function.pico8.memory",
          "match": "\\b(peek|poke|peek2|poke2|peek4|poke4|dget|dset|cartdata|reload|cstore|memcpy|memset)\\b"
        },
        {
          "name": "support.function.pico8.strings",
          "match": "\\b(tostr|tonum|chr|ord|sub)\\b"
        },
        {
          "name": "support.function.pico8.system",
          "match": "\\b(time|t|stat|printh|extcmd|menuitem|reset|run|stop|load|save|flip|fget|fset)\\b"
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.arithmetic.pico8",
          "match": "[+\\-*/%^]|\\.\\.|\\/\\/"
        },
        {
          "name": "keyword.operator.comparison.pico8",
          "match": "==|~=|!=|<=|>=|<|>"
        },
        {
          "name": "keyword.operator.assignment.pico8",
          "match": "=|\\+=|-=|\\*=|\\/=|%=|\\^=|\\.\\.="
        }
      ]
    },
    "constants": {
      "patterns": [
        {
          "name": "support.constant.pico8.color",
          "match": "\\b(black|dark_blue|dark_purple|dark_green|brown|dark_gray|light_gray|white|red|orange|yellow|green|blue|indigo|pink|peach)\\b"
        }
      ]
    }
  }
}

